# Лекція 6. Масштабування та майбутнє: L2, Rollups, ZK

**Мета:** Дати уявлення про те, як збільшують пропускну здатність і знижують вартість без втрати безпеки базового ланцюга (L1).

---

## Питання для обговорення

1. Чому транзакції в Ethereum можуть коштувати десятки доларів і що обмежує кількість транзакцій у блоці?
2. Що означає "масштабувати" блокчейн: збільшити розмір блоку, зменшити час блоку, чи щось інше?
3. Чи можна "виносити" обчислення з основного ланцюга кудись ще і все одно довіряти результату?

---

## 1. Проблема масштабування L1

У базовому ланцюгу (Bitcoin, Ethereum L1) кожен вузол перевіряє кожну транзакцію, зберігає повний стан і історію. Пропускна здатність обмежена: збільшення розміру блоку або частоти блоків збільшує вимоги до мережі та зберігання і може зменшити децентралізацію (менше вузлів зможуть повністю валідувати). Тому шукають способи обробляти більше операцій без того, щоб кожен вузол L1 обробляв кожну з них.

---

## 2. L2: загальна ідея

Layer 2 — це протоколи, що працюють "поверх" L1. Користувачі взаємодіють з L2 (дешвидше і дешевше), а безпека в кінцевому підсумку залежить від L1: або через перевірку даних на L1, або через можливість оспорити неправильний стан (fraud proof) або довести коректність стисло (ZK proof).

---

## 3. Rollups: оптимістичні та ZK

**Optimistic rollups:** зміни стану L2 публікуються на L1 у стислому вигляді (батчами). Кожен вважається правильним, якщо протягом періоду оспорення ніхто не надіслав fraud proof. Якщо хтось доведе помилку, стан відкочується. Цина: чесність залежить від наявності хоча б одного вузла, що перевіряє і може подати proof.

**ZK rollups:** зміни стану супроводжуються доказом нульового розкриття (zero-knowledge proof). L1 перевіряє доказ (швидко) і приймає новий стан без необхідності виконувати всі транзакції L2. Фінальність швидша, немає періоду оспорення; складність у генерації та перевірці доказів.

---

## 4. Інші напрямки (коротко)

- **Sidechains:** окремі ланцюги з власним консенсусом; пов’язані з L1 мостами. Безпека не та сама, що в L1.
- **DAG (Directed Acyclic Graph):** деякі проєкти (наприклад, IOTA) використовують граф транзакцій замість ланцюга блоків; інша модель консенсусу та фінальності.
- **Sharding (у Ethereum):** розділення стану та обробки на шарди; кожен вузол обробляє лише частину. Складність у комунікації між шардами та узгодженні.

---

## 5. Практичне для курсу

Студентам достатньо знати: L1 не масштабується лише збільшенням блоку; L2 (rollups) переносять обчислення "зверху", а безпека залежить від L1; optimistic rollups покладаються на fraud proofs, ZK rollups — на криптографічні докази. Деталі реалізації та інструменти (SDK, мости) можна виносити в практичні заняття або проєкти.

---

## Питання та відповіді (екзаменаційний блок)

**П1.** Чому просто збільшити розмір блоку в L1 — не ідеальне рішення?

**В1.** Більший блок означає більше даних для кожного вузла: більше пропускна здатність мережі, більше зберігання, повільніша синхронізація. Це підвищує бар’єр входу для повноцінних вузлів і може зменшити децентралізацію. Тому шукають інші способи масштабування (L2, sharding).

---

**П2.** У чому різниця між optimistic rollup і ZK rollup?

**В2.** Optimistic rollup публікує на L1 стислі дані про зміни стану L2 і вважає їх правильними, поки хтось не подасть fraud proof. Є період оспорення. ZK rollup разом із змінами стану надсилає zero-knowledge доказ коректності; L1 перевіряє доказ і приймає стан без періоду оспорення. ZK дає швидшу фінальність, але складніша в реалізації та обчисленнях.

---

**П3.** Що таке L2 і як він пов’язаний з безпекою L1?

**В3.** L2 (Layer 2) — протокол, що працює поверх базового ланцюга (L1). Користувачі взаємодіють з L2 (швидше, дешевше). Безпека в кінцевому підсумку залежить від L1: дані або докази публікуються на L1, і конфлікти можуть вирішуватися там (наприклад, через fraud proof або перевірку ZK proof).

---

**П4.** Навіщо в масштабуванні згадують fraud proof і zero-knowledge proof?

**В4.** Fraud proof використовується в optimistic rollups: якщо хтось опублікував неправильний стан L2, інший учасник може подати на L1 доказ помилки, і стан відкотиться. Zero-knowledge proof дозволяє довести коректність обчислень (наприклад, пакету транзакцій L2) без розкриття самих даних; L1 перевіряє лише доказ і приймає новий стан. Обидва механізми дозволяють не виконувати всі L2-транзакції на L1, але все одно довіряти результату.
